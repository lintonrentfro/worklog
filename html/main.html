<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkLog</title>
</head>
<body>
    <div class="container">
        {{>nav}}
        {{#if home}}
            {{>home}}
        {{/if}}
        {{#if page1}}
            Log 1.
        {{/if}}
        {{#if daily_log}}
            {{>daily_log}}
        {{/if}}
        {{#if page3}}
            {{>settings}}
        {{/if}}
    </div>
</body>

<template name="home">
    <div class="row">
        <div class="span12">Homepage stuff.</div>
    </div>
</template>

<template name="settings">
    {{#if edit_task}}
        <div class="row">
            <div class="span10">
                <h3>Edit Task</h3>
            </div>
            <div class="span2">
                <span class="pull-right"><h2><a id="close_edit_task" href="javascript:void(0)">close</a></h2></span>
            </div>
        </div>
        <div class="row">
            <div class="span12">
                <form class="form">
                    <label>Position</label>
                    <input class="span2" type="text" id="new_position" value="{{edit_task.position}}"></br>
                    <label>Name</label>
                    <input class="span4" type="text" id="new_task_name" value="{{edit_task.name}}"></br>
                    <label>Daily Deadline</label>
                    <input class="span3" type="text" id="new_deadline" value="{{edit_task.deadline}}"></br>
                    <label>Notes</label>
                    <input class="span6" type="text" id="new_notes" value="{{edit_task.notes}}"></br>
                    <button type="btn" class="btn" id="update_task">update task</button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="span6">
                <b>This Task's Group (click to remove)</b>
                </br>
                {{#if edit_task.group}}
                    <a href="javascript:void(0)">
                        <span id="remove_task_group_from_task">{{edit_task.group}}</span>
                    </a>
                    </br>
                {{/if}}
            </div>
            <div class="span6">
                <b>All Task Groups (click to add)</b>
                </br>
                {{#if task_groups}}
                    {{#each key_value task_groups}}
                        <span class="add_task_group_to_task">
                            <a href="javascript:void(0)">
                                {{value.name}}
                            </a>
                        </span>
                        </br>
                    {{/each}}
                {{/if}}
            </div>
        </div>
    {{else}}
        {{#if edit_work_item}}
            <div class="row">
                <div class="span10">
                    <h2>Editing Work Item: {{edit_work_item.name}}</h2>
                </div>
                <div class="span2">
                    <span class="pull-right"><h2><a id="close_edit_workitem" href="javascript:void(0)">close</a></h2></span>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <form class="form">
                        <div class="input-append">
                            <input class="" id="name" type="text" value="{{edit_work_item.name}}">
                            <button class="btn" type="button" id="update_work_item_name">update work item name</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    Active: {{edit_work_item.active}}
                    </br>
                    Make this a button that toggles the "active" attribute.
                </div>
            </div>
            <div class="row">
                <div class="span6">
                    <b>This Work Item's Groups (click to remove)</b>
                    </br>
                    {{#if edit_work_item.groups}}
                        {{#each key_value edit_work_item.groups}}
                            <span class="remove_work_item_group_from_work_item">
                                <a href="javascript:void(0)">
                                    {{value}}
                                </a>
                            </span>
                            </br>
                        {{/each}}
                    {{/if}}
                </div>
                <div class="span6">
                    <b>All Work Item Groups (click to add)</b>
                    </br>
                    {{#if work_item_groups}}
                        {{#each key_value work_item_groups}}
                            <span class="add_work_item_group_to_work_item">
                                <a href="javascript:void(0)">
                                    {{value.name}}
                                </a>
                            </span>
                            </br>
                        {{/each}}
                    {{/if}}
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Add Task</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <form class="form">
                        <label>Position</label>
                        <input class="span2" type="text" id="position" placeholder="example: 3"></br>
                        <label>Name</label>
                        <input class="span4" type="text" id="task_name"></br>
                        <label>Daily Deadline</label>
                        <input class="span3" type="text" id="deadline" placeholder="example: 14:30"></br>
                        <label>Notes</label>
                        <input class="span6" type="text" id="notes"></br>
                        <button type="btn" class="btn" id="add_task">add task</button>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Manage Tasks</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    {{#if edit_work_item.tasks}}
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>position</th>
                                    <th>name</th>
                                    <th>deadline</th>
                                    <th>notes</th>
                                    <th>edit</th>
                                    <th>delete</th>
                                </tr>
                            </thead>
                            {{#each key_value edit_work_item.tasks}}
                                <tr>
                                    <td>{{value.position}}</td>
                                    <td>{{value.name}}</td>
                                    <td>{{value.deadline}}</td>
                                    <td>{{value.notes}}</td>
                                    <td><span class="edit_task"><a href="javascript:void(0)">edit</a></span></td>
                                    <td><span class="delete_task"><a href="javascript:void(0)">delete</a></span></td>
                                </tr>
                            {{/each}}
                        </table>
                    {{else}}
                        none
                    {{/if}}
                </div>
            </div>
        {{else}}
            <div class="row">
                <div class="span12 gray">
                    <h2>Workers</h2>
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <h3>Add New Worker</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <form class="form">
                        <div>
                            <div id="username_group" class="control-group {{#if error_new_worker_form}}{{error_new_worker_form}}{{/if}}">
                                <input type="text" class="span2" placeholder="username" id="username">
                                <input type="text" class="span2" placeholder="password" id="password">
                            </div>
                            <button type="btn" class="btn" id="add_worker">add worker</button>
                        </div>
                    </form>
                    <h3>Manage Workers</h3>
                    {{#if workers}}
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>username</th>
                                    <th>password</th>
                                    <th>delete</th>
                                </tr>
                            </thead>
                            {{#each key_value workers}}
                                <tr>
                                    <td>{{value.username}}</td>
                                    <td>{{value.password}}</td>
                                    <td><span class="delete_worker"><a href="javascript:void(0)">delete</a></span></td>
                                </tr>
                            {{/each}}
                        </table>
                    {{/if}}
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h2>Work Items</h2>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Add New Work Item</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <form class="form">
                        <div>
                            <div id="workitem_group" class="control-group {{#if error_new_workitem_form}}{{error_new_workitem_form}}{{/if}}">
                                <input type="text" class="span2" placeholder="name" id="name">
                            </div>
                            <button type="btn" class="btn" id="add_workitem">add work item</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Manage Work Items</h3>
                    {{#if work_items}}
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>name</th>
                                    <th>last modified</th>
                                    <th>edit</th>
                                    <th>delete</th>
                                    <th>active</th>
                                </tr>
                            </thead>
                            {{#each key_value work_items}}
                                <tr>
                                    <td>{{value.name}}</td>
                                    <td>{{value.last_modified}}</td>
                                    <td><span class="edit_workitem"><a href="javascript:void(0)">edit</a></span></td>
                                    <td><span class="delete_workitem"><a href="javascript:void(0)">delete</a></span></td>
                                    <td><span class="toggle_workitem_active"><a href="javascript:void(0)">{{value.active}}</a></span></td>
                                </tr>
                            {{/each}}
                        </table>
                    {{/if}}
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <h2>Work Item Groups</h2>
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <h3>Add New Work Item Group</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <form class="form">
                        <div>
                            <div id="workitem_group_group" class="control-group">
                                <input type="text" class="span2" placeholder="name" id="work_item_group_name">
                            </div>
                            <button type="btn" class="btn" id="add_work_item_group">add work item group</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="span12 gray">
                    <h3>Manage Work Item Groups</h3>
                    {{#if work_item_groups}}
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>name</th>
                                    <th>delete</th>
                                </tr>
                            </thead>
                            {{#each key_value work_item_groups}}
                                <tr>
                                    <td>{{value.name}}</td>
                                    <td><span class="delete_work_item_group"><a href="javascript:void(0)">delete</a></span></td>
                                </tr>
                            {{/each}}
                        </table>
                    {{else}}
                        none
                    {{/if}}
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h2>Task Groups</h2>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Add New Task Group</h3>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <form class="form">
                        <div>
                            <div id="task_group_group" class="control-group">
                                <input type="text" class="span2" placeholder="name" id="task_group_name">
                            </div>
                            <button type="btn" class="btn" id="add_task_group">add task group</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="span12">
                    <h3>Manage Task Groups</h3>
                    {{#if task_groups}}
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>name</th>
                                    <th>delete</th>
                                </tr>
                            </thead>
                            {{#each key_value task_groups}}
                                <tr>
                                    <td>{{value.name}}</td>
                                    <td><span class="delete_task_group"><a href="javascript:void(0)">delete</a></span></td>
                                </tr>
                            {{/each}}
                        </table>
                    {{else}}
                        none
                    {{/if}}
                </div>
            </div>
        {{/if}}
    {{/if}}
</template>

<template name="nav">
    <div class="navbar">
        <div class="navbar-inner">
            <a id="home" class="brand" href="javascript:void(0)">WorkLog</a>
            <ul class="nav">
                {{#if is_logged_in}}
                    <li id="page1" class="{{#if page1}}{{page1}}{{/if}}">
                        <a href="javascript:void(0)">Page1</a>
                    </li>
                    <li id="daily_log" class="{{#if daily_log}}{{daily_log}}{{/if}}">
                        <a href="javascript:void(0)">daily log</a>
                    </li>
                {{/if}}
                {{#if is_admin}}
                    <li id="page3" class="{{#if page3}}{{page3}}{{/if}}">
                        <a href="javascript:void(0)">Settings</a>
                    </li>
                {{/if}}
            </ul>
            {{#if is_logged_in}}
                <form class="navbar-form pull-right">
                    <button type="btn" class="btn" id="logout">logout as {{is_logged_in.username}}</button>
                </form>
            {{else}}
                <form class="navbar-form pull-right">
                    <div id="login_form">
                        <div id="username_group" class="control-group">
                        <input type="text" class="span2" placeholder="username" id="username">
                        <input type="password" class="span2" placeholder="password" id="password">
                        <button type="btn" class="btn" id="login">login</button>
                    </div>
                </form>
            {{/if}}
        </div>
    </div>
</template>

<template name="daily_log">
    <div class="row">
        <div class="span4">
            {{#if todays_log}}
                <b>WI Groups</b></br>
                <span id="toggle_all_wi_groups" class="pointer">*Toggle All*</span></br>
                {{#if wi_groups}}
                    {{#each key_value wi_groups}}
                        <span class="filter_wi_group {{value.visual}}">{{value.name}}</span></br>
                    {{/each}}
                {{/if}}
            {{/if}}
        </div>
        <div class="span4" align="center">
            {{#if todays_log}}
                <b>
                    <span style="font-size:24pt">
                        {{todays_log.day}}
                    </span>
                </b>
                <p>
                    <div class="input-append">
                        <input class="span3" id="log_date" type="text" placeholder="ex: 2014-04-12">
                        <button class="btn" id="load_log_with_date" type="button">Load</button>
                    </div>
                </p>
            {{else}}
                <p>
                    <b>
                        <span style="font-size:20pt">
                            No Log For Today
                        </span>
                    </b>
                </p>
                <div class="input-append">
                    <input class="span3" id="log_date" type="text" placeholder="ex: 2014-04-12">
                    <button class="btn" id="load_log_with_date" type="button">Load</button>
                </div>
                <p>
                    <button id="start_todays_log" class="btn" type="button">Start Today's Log</button>
                </p>
            {{/if}}
        </div>
        <div class="span4" align="right">
            {{#if todays_log}}
                <b align="right">Task Groups</b></br>
                <span id="toggle_all_task_groups" class="pointer">*Toggle All*</span></br>
                {{#if task_groups}}
                    {{#each key_value task_groups}}
                        <span class="filter_task_group {{value.visual}}">{{value.name}}</span></br>
                    {{/each}}
                {{/if}}
            {{/if}}
        </div>
    </div>
    <div class="row">
        <div class="span12">
            {{#if todays_log}}
                <hr>
            {{/if}}
        </div>
    </div>
    <div class="row">
        <div class="span12">
        {{#if todays_log}}
            {{#each key_value todays_log.work_items}}
                <table class="table table-bordered {{value.visible}}">
                    <tr>
                        <td class="log_work_item">
                            {{#if value.recently_changed}}*{{/if}}{{value.name}}
                        </td>
                        {{#each key_value value.tasks}}
                            <td class="work_item_task {{value.visible}} {{value.lateness}} pointer" {{#if value.notes}} rel="tooltip" title="{{value.notes}}"{{else}} rel="tooltip" title="no notes"{{/if}}>
                                {{value.name}}
                                </br>
                                <span class="task_deadline">
                                    {{value.deadline}}
                                </span>
                            </td>
                        {{/each}}
                    </tr>
                </table>
            {{/each}}
        {{/if}}
        </div>
    </div>
</template>